## Before 1-JUL-23 CURRENT YEAR IS FINANCIAL YEAR
## After that July To June Financial Year.

CREATE OR REPLACE FUNCTION GET_FINANCIAL_YEAR (pINPUT_DATE DATE, pSTART_MONTH NUMBER DEFAULT 7)
RETURN NUMBER
IS
    vRETURN NUMBER;
    vMONTH_ID   NUMBER := EXTRACT (MONTH FROM pINPUT_DATE);
BEGIN

    IF (pINPUT_DATE < '1-JUL-23' OR pSTART_MONTH = 1) THEN
        vRETURN := EXTRACT (YEAR FROM pINPUT_DATE);
    ELSIF pSTART_MONTH = 7 THEN

        IF vMONTH_ID BETWEEN 1 AND 6 THEN
            vRETURN := EXTRACT (YEAR FROM pINPUT_DATE);
            vRETURN := vRETURN ;
        ELSIF vMONTH_ID BETWEEN 7 AND 12 THEN
            vRETURN := EXTRACT (YEAR FROM pINPUT_DATE) + 1;
        END IF;        
        
    END IF;
    
    RETURN vRETURN;

END GET_FINANCIAL_YEAR;


--CALLING
--


SELECT GET_FINANCIAL_YEAR (TO_DATE ('02072024','DDMMRRRR')) YR FROM DUAL
